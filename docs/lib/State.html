<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="../styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="../bin/Metacalls.html">bin/Metacalls</a></li></li><li><li><a href="../lib/Common.html">lib/Common</a></li></li><li><li><a href="../lib/IcManagement.html">lib/IcManagement</a></li></li><li><li><a href="../lib/Metacalls.html">lib/Metacalls</a></li></li><li><li><a href="../lib/State.html">lib/State</a></li></li><li><li><a href="../lib/Types.html">lib/Types</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.Env">Env</a></li></li><li><li><a href="#type.Config">Config</a></li></li><li><li><a href="#type.MessageStatus">MessageStatus</a></li></li><li><li><a href="#type.State">State</a></li></li><li><li><a href="#initState">initState</a></li></li><li><li><a href="#addDerivedIdentity">addDerivedIdentity</a></li></li><li><li><a href="#getDerivedIdentity">getDerivedIdentity</a></li></li><li><li><a href="#getAllDerivedIdentities">getAllDerivedIdentities</a></li></li><li><li><a href="#setMessage">setMessage</a></li></li><li><li><a href="#getMessage">getMessage</a></li></li><li><li><a href="#getAllMessages">getAllMessages</a></li></li><li><li><a href="#updateMessageTtl">updateMessageTtl</a></li></li><li><li><a href="#cleanupExpiredMessages">cleanupExpiredMessages</a></li></li></ul></nav><div class="documentation"><h1>lib/State</h1><p>State stored by the library.</p>
<p>As a library user, you should rarely have to interact with this module directly.</p>
<div class="declaration"><h4 class="type-declaration" id="type.Env"><span class="keyword">type </span><span class="type">Env</span> = {#Local; #Staging; #Production}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Config"><span class="keyword">type </span><span class="type">Config</span> = { env : <a href="#type.Env"><span class="type">Env</span></a>; key_name : <span class="type">Text</span>; sign_cycles : <span class="type">Nat</span>; <span class="keyword">var </span>message_ttl_secs : <span class="type">Int</span> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.MessageStatus"><span class="keyword">type </span><span class="type">MessageStatus</span> = {#Created; #Signed; #Sent}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.State"><span class="keyword">type </span><span class="type">State</span> = { config : <a href="#type.Config"><span class="type">Config</span></a>; <span class="keyword">var </span>identities : <a href="#type.Map"><span class="type">Map</span></a>&lt;<span class="type">Text</span>, <a href="#type.PIdentity"><span class="type">PIdentity</span></a>&gt;; <span class="keyword">var </span>messages : <a href="#type.Map"><span class="type">Map</span></a>&lt;<span class="type">Text</span>, <a href="#type.Message"><span class="type">Message</span></a>&gt; }</h4><p></p></div><div class="declaration"><h4 class="function" id="initState"><code><span class="keyword">public func </span><span class="fnname">initState</span>(<span class="parameter">env</span> : <a href="#type.Env"><span class="type">Env</span></a>) : <a href="#type.State"><span class="type">State</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="addDerivedIdentity"><code><span class="keyword">public func </span><span class="fnname">addDerivedIdentity</span>(<br/>  <span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>, <br/>  <span class="parameter">key_name</span> : <span class="type">Text</span>, <br/>  <span class="parameter">pub_key</span> : <span class="type">Blob</span><br/>)</code></h4><p></p></div><div class="declaration"><h4 class="function" id="getDerivedIdentity"><code><span class="keyword">public func </span><span class="fnname">getDerivedIdentity</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>, <span class="parameter">key_name</span> : <span class="type">Text</span>) : ?<a href="#type.PIdentity"><span class="type">PIdentity</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="getAllDerivedIdentities"><code><span class="keyword">public func </span><span class="fnname">getAllDerivedIdentities</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>) : [<a href="#type.PIdentity"><span class="type">PIdentity</span></a>]</code></h4><p></p></div><div class="declaration"><h4 class="function" id="setMessage"><code><span class="keyword">public func </span><span class="fnname">setMessage</span>(<br/>  <span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>, <br/>  <span class="parameter">uuid</span> : <a href="#type.UUID"><span class="type">UUID</span></a>, <br/>  <span class="parameter">msg</span> : <a href="#type.Message"><span class="type">Message</span></a><br/>)</code></h4><p></p></div><div class="declaration"><h4 class="function" id="getMessage"><code><span class="keyword">public func </span><span class="fnname">getMessage</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>, <span class="parameter">uuid</span> : <a href="#type.UUID"><span class="type">UUID</span></a>) : ?<a href="#type.Message"><span class="type">Message</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="getAllMessages"><code><span class="keyword">public func </span><span class="fnname">getAllMessages</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>) : [<a href="#type.Message"><span class="type">Message</span></a>]</code></h4><p></p></div><div class="declaration"><h4 class="function" id="updateMessageTtl"><code><span class="keyword">public func </span><span class="fnname">updateMessageTtl</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>, <span class="parameter">new_ttl_secs</span> : <span class="type">Int</span>)</code></h4><p></p></div><div class="declaration"><h4 class="function" id="cleanupExpiredMessages"><code><span class="keyword">public func </span><span class="fnname">cleanupExpiredMessages</span>(<span class="parameter">s</span> : <a href="#type.State"><span class="type">State</span></a>) : [<a href="#type.UUID"><span class="type">UUID</span></a>]</code></h4><p></p></div></div></body></html>